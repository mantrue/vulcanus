{
  "iptables-rules": {
    "-version": "1.0",
    "table": [
      {
        "-name": "nat",
        "chain": [
          {
            "-name": "PREROUTING",
            "-policy": "ACCEPT",
            "-packet-count": "0",
            "-byte-count": "0",
            "rule": [
              {
                "conditions": {
                  "comment": { "comment": "\"kubernetes service portals\"" }
                },
                "actions": {
                  "call": {

                  }
                }
              },
              {
                "conditions": {
                  "addrtype": { "dst-type": "LOCAL" }
                },
                "actions": {
                  "call": {

                  }
                }
              }
            ]
          },
          {
            "-name": "OUTPUT",
            "-policy": "ACCEPT",
            "-packet-count": "17",
            "-byte-count": "1020",
            "rule": [
              {
                "conditions": {
                  "comment": { "comment": "\"kubernetes service portals\"" }
                },
                "actions": {
                  "call": {

                  }
                }
              },
              {
                "conditions": {
                  "match": {
                    "d": {
                      "-invert": "1",
                      "#text": "127.0.0.0/8"
                    }
                  },
                  "addrtype": { "dst-type": "LOCAL" }
                },
                "actions": {
                  "call": {

                  }
                }
              }
            ]
          },
          {
            "-name": "POSTROUTING",
            "-policy": "ACCEPT",
            "-packet-count": "17",
            "-byte-count": "1020",
            "rule": [
              {
                "conditions": {
                  "comment": { "comment": "\"kubernetes postrouting rules\"" }
                },
                "actions": {
                  "call": {

                  }
                }
              },
              {
                "conditions": {
                  "match": {
                    "s": "172.17.0.0/16",
                    "o": {
                      "-invert": "1",
                      "#text": "docker0"
                    }
                  }
                },
                "actions": {

                }
              },
              {
                "conditions": {
                  "match": {
                    "s": "172.17.0.7/32",
                    "d": "172.17.0.7/32",
                    "p": "tcp"
                  },
                  "tcp": { "dport": "18080" }
                },
                "actions": {

                }
              },
              {
                "conditions": {
                  "match": {
                    "s": "172.17.0.7/32",
                    "d": "172.17.0.7/32",
                    "p": "tcp"
                  },
                  "tcp": { "dport": "443" }
                },
                "actions": {

                }
              },
              {
                "conditions": {
                  "match": {
                    "s": "172.17.0.7/32",
                    "d": "172.17.0.7/32",
                    "p": "tcp"
                  },
                  "tcp": { "dport": "80" }
                },
                "actions": {

                }
              }
            ]
          },
          {
            "-name": "DOCKER",
            "-packet-count": "0",
            "-byte-count": "0",
            "rule": [
              {
                "conditions": {
                  "match": { "i": "docker0" }
                },
                "actions": {

                }
              },
              {
                "conditions": {
                  "match": {
                    "i": {
                      "-invert": "1",
                      "#text": "docker0"
                    },
                    "p": "tcp"
                  },
                  "tcp": { "dport": "18080" }
                },
                "actions": {
                  "DNAT": { "to-destination": "172.17.0.7:18080" }
                }
              },
              {
                "conditions": {
                  "match": {
                    "i": {
                      "-invert": "1",
                      "#text": "docker0"
                    },
                    "p": "tcp"
                  },
                  "tcp": { "dport": "443" }
                },
                "actions": {
                  "DNAT": { "to-destination": "172.17.0.7:443" }
                }
              },
              {
                "conditions": {
                  "match": {
                    "i": {
                      "-invert": "1",
                      "#text": "docker0"
                    },
                    "p": "tcp"
                  },
                  "tcp": { "dport": "80" }
                },
                "actions": {
                  "DNAT": { "to-destination": "172.17.0.7:80" }
                }
              }
            ]
          },
          {
            "-name": "KUBE-MARK-DROP",
            "-packet-count": "0",
            "-byte-count": "0",
            "rule": {
              "actions": {
                "MARK": { "set-xmark": "0x8000/0x8000" }
              }
            }
          },
          {
            "-name": "KUBE-MARK-MASQ",
            "-packet-count": "0",
            "-byte-count": "0",
            "rule": {
              "actions": {
                "MARK": { "set-xmark": "0x4000/0x4000" }
              }
            }
          },
          {
            "-name": "KUBE-NODEPORTS",
            "-packet-count": "0",
            "-byte-count": "0",
            "rule": [
              {
                "conditions": {
                  "match": { "p": "tcp" },
                  "comment": { "comment": "\"default/web2:\"" },
                  "tcp": { "dport": "31979" }
                },
                "actions": {
                  "call": {

                  }
                }
              },
              {
                "conditions": {
                  "match": { "p": "tcp" },
                  "comment": { "comment": "\"default/web2:\"" },
                  "tcp": { "dport": "31979" }
                },
                "actions": {
                  "call": {

                  }
                }
              },
              {
                "conditions": {
                  "match": { "p": "tcp" },
                  "comment": { "comment": "\"default/web:\"" },
                  "tcp": { "dport": "31386" }
                },
                "actions": {
                  "call": {

                  }
                }
              },
              {
                "conditions": {
                  "match": { "p": "tcp" },
                  "comment": { "comment": "\"default/web:\"" },
                  "tcp": { "dport": "31386" }
                },
                "actions": {
                  "call": {

                  }
                }
              }
            ]
          },
          {
            "-name": "KUBE-POSTROUTING",
            "-packet-count": "0",
            "-byte-count": "0",
            "rule": [
              {
                "conditions": {
                  "comment": { "comment": "\"kubernetes service traffic requiring SNAT\"" },
                  "mark": { "mark": "0x4000/0x4000" }
                },
                "actions": {

                }
              },
              {
                "conditions": {
                  "comment": { "comment": "\"kubernetes service traffic requiring SNAT\"" },
                  "mark": { "mark": "0x4000/0x4000" }
                },
                "actions": {
                  "MASQUERADE": {

                  }
                }
              }
            ]
          },
          {
            "-name": "KUBE-SEP-7PPXA5JT5ALVQPIV",
            "-packet-count": "0",
            "-byte-count": "0",
            "rule": [
              {
                "conditions": {
                  "match": { "s": "172.17.0.2/32" }
                },
                "actions": {
                  "call": {

                  }
                }
              },
              {
                "conditions": {
                  "match": { "p": "tcp" }
                },
                "actions": {
                  "DNAT": { "to-destination": "172.17.0.2:53" }
                }
              }
            ]
          },
          {
            "-name": "KUBE-SEP-ACMXUHMI3Y3O3GQI",
            "-packet-count": "0",
            "-byte-count": "0",
            "rule": [
              {
                "conditions": {
                  "match": { "s": "172.17.0.5/32" }
                },
                "actions": {
                  "call": {

                  }
                }
              },
              {
                "conditions": {
                  "match": { "p": "tcp" }
                },
                "actions": {
                  "DNAT": { "to-destination": "172.17.0.5:8000" }
                }
              }
            ]
          },
          {
            "-name": "KUBE-SEP-CPJSBS35VMSBOKH6",
            "-packet-count": "0",
            "-byte-count": "0",
            "rule": [
              {
                "conditions": {
                  "match": { "s": "172.17.0.3/32" }
                },
                "actions": {
                  "call": {

                  }
                }
              },
              {
                "conditions": {
                  "match": { "p": "tcp" }
                },
                "actions": {
                  "DNAT": { "to-destination": "172.17.0.3:53" }
                }
              }
            ]
          },
          {
            "-name": "KUBE-SEP-DSL7LUEVWMEJDZFH",
            "-packet-count": "0",
            "-byte-count": "0",
            "rule": [
              {
                "conditions": {
                  "match": { "s": "172.17.0.2/32" }
                },
                "actions": {
                  "call": {

                  }
                }
              },
              {
                "conditions": {
                  "match": { "p": "tcp" }
                },
                "actions": {
                  "DNAT": { "to-destination": "172.17.0.2:9153" }
                }
              }
            ]
          },
          {
            "-name": "KUBE-SEP-GTBAIJRJONITTAWL",
            "-packet-count": "0",
            "-byte-count": "0",
            "rule": [
              {
                "conditions": {
                  "match": { "s": "172.17.0.4/32" }
                },
                "actions": {
                  "call": {

                  }
                }
              },
              {
                "conditions": {
                  "match": { "p": "tcp" }
                },
                "actions": {
                  "DNAT": { "to-destination": "172.17.0.4:8080" }
                }
              }
            ]
          },
          {
            "-name": "KUBE-SEP-K7JQ5XSWBQ7MTKDL",
            "-packet-count": "0",
            "-byte-count": "0",
            "rule": [
              {
                "conditions": {
                  "match": { "s": "172.17.0.3/32" }
                },
                "actions": {
                  "call": {

                  }
                }
              },
              {
                "conditions": {
                  "match": { "p": "udp" }
                },
                "actions": {
                  "DNAT": { "to-destination": "172.17.0.3:53" }
                }
              }
            ]
          },
          {
            "-name": "KUBE-SEP-LCXBCGOSUD73XZW5",
            "-packet-count": "0",
            "-byte-count": "0",
            "rule": [
              {
                "conditions": {
                  "match": { "s": "192.168.99.101/32" }
                },
                "actions": {
                  "call": {

                  }
                }
              },
              {
                "conditions": {
                  "match": { "p": "tcp" }
                },
                "actions": {
                  "DNAT": { "to-destination": "192.168.99.101:8443" }
                }
              }
            ]
          },
          {
            "-name": "KUBE-SEP-MJ4C7PP2DS74GGQA",
            "-packet-count": "0",
            "-byte-count": "0",
            "rule": [
              {
                "conditions": {
                  "match": { "s": "172.17.0.3/32" }
                },
                "actions": {
                  "call": {

                  }
                }
              },
              {
                "conditions": {
                  "match": { "p": "tcp" }
                },
                "actions": {
                  "DNAT": { "to-destination": "172.17.0.3:9153" }
                }
              }
            ]
          },
          {
            "-name": "KUBE-SEP-RASSW3STCNEGZXVE",
            "-packet-count": "0",
            "-byte-count": "0",
            "rule": [
              {
                "conditions": {
                  "match": { "s": "172.17.0.8/32" }
                },
                "actions": {
                  "call": {

                  }
                }
              },
              {
                "conditions": {
                  "match": { "p": "tcp" }
                },
                "actions": {
                  "DNAT": { "to-destination": "172.17.0.8:8080" }
                }
              }
            ]
          },
          {
            "-name": "KUBE-SEP-SNPTLXDNVSPZ5ND2",
            "-packet-count": "0",
            "-byte-count": "0",
            "rule": [
              {
                "conditions": {
                  "match": { "s": "172.17.0.2/32" }
                },
                "actions": {
                  "call": {

                  }
                }
              },
              {
                "conditions": {
                  "match": { "p": "udp" }
                },
                "actions": {
                  "DNAT": { "to-destination": "172.17.0.2:53" }
                }
              }
            ]
          },
          {
            "-name": "KUBE-SEP-UN62CHL66DBUYA27",
            "-packet-count": "0",
            "-byte-count": "0",
            "rule": [
              {
                "conditions": {
                  "match": { "s": "172.17.0.6/32" }
                },
                "actions": {
                  "call": {

                  }
                }
              },
              {
                "conditions": {
                  "match": { "p": "tcp" }
                },
                "actions": {
                  "DNAT": { "to-destination": "172.17.0.6:9090" }
                }
              }
            ]
          },
          {
            "-name": "KUBE-SERVICES",
            "-packet-count": "0",
            "-byte-count": "0",
            "rule": [
              {
                "conditions": {
                  "match": {
                    "d": "10.96.0.10/32",
                    "p": "tcp"
                  },
                  "comment": { "comment": "\"kube-system/kube-dns:dns-tcp cluster IP\"" },
                  "tcp": { "dport": "53" }
                },
                "actions": {
                  "call": {

                  }
                }
              },
              {
                "conditions": {
                  "match": {
                    "d": "10.96.0.10/32",
                    "p": "tcp"
                  },
                  "comment": { "comment": "\"kube-system/kube-dns:metrics cluster IP\"" },
                  "tcp": { "dport": "9153" }
                },
                "actions": {
                  "call": {

                  }
                }
              },
              {
                "conditions": {
                  "match": {
                    "d": "10.96.63.186/32",
                    "p": "tcp"
                  },
                  "comment": { "comment": "\"kubernetes-dashboard/dashboard-metrics-scraper: cluster IP\"" },
                  "tcp": { "dport": "8000" }
                },
                "actions": {
                  "call": {

                  }
                }
              },
              {
                "conditions": {
                  "match": {
                    "d": "10.108.137.169/32",
                    "p": "tcp"
                  },
                  "comment": { "comment": "\"default/web2: cluster IP\"" },
                  "tcp": { "dport": "8080" }
                },
                "actions": {
                  "call": {

                  }
                }
              },
              {
                "conditions": {
                  "match": {
                    "d": "10.100.122.107/32",
                    "p": "tcp"
                  },
                  "comment": { "comment": "\"kubernetes-dashboard/kubernetes-dashboard: cluster IP\"" },
                  "tcp": { "dport": "80" }
                },
                "actions": {
                  "call": {

                  }
                }
              },
              {
                "conditions": {
                  "match": {
                    "d": "10.96.0.1/32",
                    "p": "tcp"
                  },
                  "comment": { "comment": "\"default/kubernetes:https cluster IP\"" },
                  "tcp": { "dport": "443" }
                },
                "actions": {
                  "call": {

                  }
                }
              },
              {
                "conditions": {
                  "match": {
                    "d": "10.107.97.79/32",
                    "p": "tcp"
                  },
                  "comment": { "comment": "\"default/web: cluster IP\"" },
                  "tcp": { "dport": "8080" }
                },
                "actions": {
                  "call": {

                  }
                }
              },
              {
                "conditions": {
                  "match": {
                    "d": "10.96.0.10/32",
                    "p": "udp"
                  },
                  "comment": { "comment": "\"kube-system/kube-dns:dns cluster IP\"" },
                  "udp": { "dport": "53" }
                },
                "actions": {
                  "call": {

                  }
                }
              },
              {
                "conditions": {
                  "comment": { "comment": "\"kubernetes service nodeports; NOTE: this must be the last rule in this chain\"" },
                  "addrtype": { "dst-type": "LOCAL" }
                },
                "actions": {
                  "call": {

                  }
                }
              }
            ]
          },
          {
            "-name": "KUBE-SVC-4CRUJHTV5RT5YMFY",
            "-packet-count": "0",
            "-byte-count": "0",
            "rule": {
              "actions": {
                "call": {

                }
              }
            }
          },
          {
            "-name": "KUBE-SVC-7UGYW7HVUL5B72AK",
            "-packet-count": "0",
            "-byte-count": "0",
            "rule": {
              "actions": {
                "call": {

                }
              }
            }
          },
          {
            "-name": "KUBE-SVC-BIJGBSD4RZCCZX5R",
            "-packet-count": "0",
            "-byte-count": "0",
            "rule": {
              "actions": {
                "call": {

                }
              }
            }
          },
          {
            "-name": "KUBE-SVC-ERIFXISQEP7F7OF4",
            "-packet-count": "0",
            "-byte-count": "0",
            "rule": [
              {
                "conditions": {
                  "statistic": {
                    "mode": "random",
                    "probability": "0.50000000000"
                  }
                },
                "actions": {
                  "call": {

                  }
                }
              },
              {
                "actions": {
                  "call": {

                  }
                }
              }
            ]
          },
          {
            "-name": "KUBE-SVC-JD5MR3NA4I4DYORP",
            "-packet-count": "0",
            "-byte-count": "0",
            "rule": [
              {
                "conditions": {
                  "statistic": {
                    "mode": "random",
                    "probability": "0.50000000000"
                  }
                },
                "actions": {
                  "call": {

                  }
                }
              },
              {
                "actions": {
                  "call": {

                  }
                }
              }
            ]
          },
          {
            "-name": "KUBE-SVC-NDSMHFCKXJRPU4FV",
            "-packet-count": "0",
            "-byte-count": "0",
            "rule": {
              "actions": {
                "call": {

                }
              }
            }
          },
          {
            "-name": "KUBE-SVC-NPX46M4PTMTKRN6Y",
            "-packet-count": "0",
            "-byte-count": "0",
            "rule": {
              "actions": {
                "call": {

                }
              }
            }
          },
          {
            "-name": "KUBE-SVC-TCOU7JCQXEZGVUNU",
            "-packet-count": "0",
            "-byte-count": "0",
            "rule": [
              {
                "conditions": {
                  "statistic": {
                    "mode": "random",
                    "probability": "0.50000000000"
                  }
                },
                "actions": {
                  "call": {

                  }
                }
              },
              {
                "actions": {
                  "call": {

                  }
                }
              }
            ]
          },
          {
            "-name": "INPUT",
            "-policy": "ACCEPT",
            "-packet-count": "0",
            "-byte-count": "0"
          }
        ]
      },
      {
        "-name": "mangle",
        "chain": [
          {
            "-name": "PREROUTING",
            "-policy": "ACCEPT",
            "-packet-count": "99429202",
            "-byte-count": "32155370531"
          },
          {
            "-name": "INPUT",
            "-policy": "ACCEPT",
            "-packet-count": "99428910",
            "-byte-count": "32155349402"
          },
          {
            "-name": "FORWARD",
            "-policy": "ACCEPT",
            "-packet-count": "286",
            "-byte-count": "18721"
          },
          {
            "-name": "OUTPUT",
            "-policy": "ACCEPT",
            "-packet-count": "99834042",
            "-byte-count": "32036328513"
          },
          {
            "-name": "POSTROUTING",
            "-policy": "ACCEPT",
            "-packet-count": "99834337",
            "-byte-count": "32036347720"
          }
        ]
      },
      {
        "-name": "filter",
        "chain": [
          {
            "-name": "INPUT",
            "-policy": "ACCEPT",
            "-packet-count": "4857",
            "-byte-count": "1414610",
            "rule": [
              {
                "conditions": {
                  "match": { "s": "0.0.0.0/32" }
                },
                "actions": {

                }
              },
              {
                "conditions": {
                  "conntrack": { "ctstate": "NEW" },
                  "comment": { "comment": "\"kubernetes service portals\"" }
                },
                "actions": {
                  "call": {

                  }
                }
              },
              {
                "conditions": {
                  "conntrack": { "ctstate": "NEW" },
                  "comment": { "comment": "\"kubernetes externally-visible service portals\"" }
                },
                "actions": {
                  "call": {

                  }
                }
              },
              {
                "actions": {
                  "call": {

                  }
                }
              }
            ]
          },
          {
            "-name": "FORWARD",
            "-policy": "ACCEPT",
            "-packet-count": "0",
            "-byte-count": "0",
            "rule": [
              {
                "conditions": {
                  "comment": { "comment": "\"kubernetes forwarding rules\"" }
                },
                "actions": {
                  "call": {

                  }
                }
              },
              {
                "conditions": {
                  "conntrack": { "ctstate": "NEW" },
                  "comment": { "comment": "\"kubernetes service portals\"" }
                },
                "actions": {
                  "call": {

                  }
                }
              },
              {
                "actions": {
                  "call": {

                  }
                }
              },
              {
                "actions": {
                  "call": {

                  }
                }
              },
              {
                "conditions": {
                  "match": { "o": "docker0" },
                  "conntrack": { "ctstate": "RELATED,ESTABLISHED" }
                },
                "actions": {

                }
              },
              {
                "conditions": {
                  "match": { "o": "docker0" }
                },
                "actions": {
                  "call": {

                  }
                }
              },
              {
                "conditions": {
                  "match": {
                    "i": "docker0",
                    "o": {
                      "-invert": "1",
                      "#text": "docker0"
                    }
                  }
                },
                "actions": {

                }
              },
              {
                "conditions": {
                  "match": {
                    "i": "docker0",
                    "o": "docker0"
                  }
                },
                "actions": {

                }
              }
            ]
          },
          {
            "-name": "OUTPUT",
            "-policy": "ACCEPT",
            "-packet-count": "4900",
            "-byte-count": "1444463",
            "rule": [
              {
                "conditions": {
                  "conntrack": { "ctstate": "NEW" },
                  "comment": { "comment": "\"kubernetes service portals\"" }
                },
                "actions": {
                  "call": {

                  }
                }
              },
              {
                "actions": {
                  "call": {

                  }
                }
              }
            ]
          },
          {
            "-name": "DOCKER",
            "-packet-count": "0",
            "-byte-count": "0",
            "rule": [
              {
                "conditions": {
                  "match": {
                    "d": "172.17.0.7/32",
                    "i": {
                      "-invert": "1",
                      "#text": "docker0"
                    },
                    "o": "docker0",
                    "p": "tcp"
                  },
                  "tcp": { "dport": "18080" }
                },
                "actions": {

                }
              },
              {
                "conditions": {
                  "match": {
                    "d": "172.17.0.7/32",
                    "i": {
                      "-invert": "1",
                      "#text": "docker0"
                    },
                    "o": "docker0",
                    "p": "tcp"
                  },
                  "tcp": { "dport": "443" }
                },
                "actions": {

                }
              },
              {
                "conditions": {
                  "match": {
                    "d": "172.17.0.7/32",
                    "i": {
                      "-invert": "1",
                      "#text": "docker0"
                    },
                    "o": "docker0",
                    "p": "tcp"
                  },
                  "tcp": { "dport": "80" }
                },
                "actions": {

                }
              }
            ]
          },
          {
            "-name": "DOCKER-ISOLATION-STAGE-1",
            "-packet-count": "0",
            "-byte-count": "0",
            "rule": [
              {
                "conditions": {
                  "match": {
                    "i": "docker0",
                    "o": {
                      "-invert": "1",
                      "#text": "docker0"
                    }
                  }
                },
                "actions": {
                  "call": {

                  }
                }
              },
              {
                "actions": {

                }
              }
            ]
          },
          {
            "-name": "DOCKER-ISOLATION-STAGE-2",
            "-packet-count": "0",
            "-byte-count": "0",
            "rule": [
              {
                "conditions": {
                  "match": { "o": "docker0" }
                },
                "actions": {

                }
              },
              {
                "actions": {

                }
              }
            ]
          },
          {
            "-name": "DOCKER-USER",
            "-packet-count": "0",
            "-byte-count": "0",
            "rule": {
              "actions": {

              }
            }
          },
          {
            "-name": "KUBE-FIREWALL",
            "-packet-count": "0",
            "-byte-count": "0",
            "rule": {
              "conditions": {
                "comment": { "comment": "\"kubernetes firewall for dropping marked packets\"" },
                "mark": { "mark": "0x8000/0x8000" }
              },
              "actions": {

              }
            }
          },
          {
            "-name": "KUBE-FORWARD",
            "-packet-count": "0",
            "-byte-count": "0",
            "rule": [
              {
                "conditions": {
                  "conntrack": { "ctstate": "INVALID" }
                },
                "actions": {

                }
              },
              {
                "conditions": {
                  "comment": { "comment": "\"kubernetes forwarding rules\"" },
                  "mark": { "mark": "0x4000/0x4000" }
                },
                "actions": {

                }
              }
            ]
          },
          {
            "-name": "KUBE-EXTERNAL-SERVICES",
            "-packet-count": "0",
            "-byte-count": "0"
          },
          {
            "-name": "KUBE-SERVICES",
            "-packet-count": "0",
            "-byte-count": "0"
          }
        ]
      }
    ]
  }
}